from __future__ import print_function import tensorflow as tf import numpy as np import odl import odl . contrib . tensorflow sess = tf . InteractiveSession ( ) matrix = np . array ( [ [ 1 , 2 ] , [ 0 , 0 ] , [ 0 , 1 ] ] , dtype = <str> ) odl_op = odl . MatrixOperator ( matrix ) x = [ 1. , 2. ] z = [ 1. , 2. , 3. ] x_tf = tf . constant ( x ) [ None , ... , None ] z_tf = tf . constant ( z ) [ None , ... , None ] odl_op_layer = odl . contrib . tensorflow . as_tensorflow_layer ( odl_op , <str> ) y_tf = odl_op_layer ( x_tf ) print ( <str> , y_tf . eval ( ) . ravel ( ) ) print ( <str> , odl_op ( x ) ) print ( <str> , tf . gradients ( y_tf , [ x_tf ] , z_tf ) [ 0 ] . eval ( ) . ravel ( ) ) print ( <str> , odl_op . derivative ( x ) . adjoint ( z ) )  