import numpy as np import scipy . optimize __all__ = ( <str> , ) def optimal_parameters ( reconstruction , fom , phantoms , data , initial = None , univariate = False ) :      <str> def func ( lam ) :          return sum ( fom ( reconstruction ( datai , lam ) , phantomi ) for phantomi , datai in zip ( phantoms , data ) )  tol = np . finfo ( phantoms [ 0 ] . space . dtype ) . resolution * 10 if univariate :          result = scipy . optimize . minimize_scalar ( func , bracket = initial , tol = tol , bounds = None , options = { <str> : False } ) return result . x  else :          initial = np . asarray ( initial ) parameters = scipy . optimize . fmin_powell ( func , initial , xtol = tol , ftol = tol , disp = False ) return parameters    