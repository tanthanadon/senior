from __future__ import division from __future__ import print_function import matplotlib . pyplot as plt import numpy as np import ehtim as eh from ehtim . calibrating import self_cal as sc im = eh . image . load_txt ( <str> ) eht = eh . array . load_txt ( <str> ) tint_sec = 5 tadv_sec = 600 tstart_hr = 0 tstop_hr = 24 bw_hz = 400e9 obs = im . observe ( eht , tint_sec , tadv_sec , tstart_hr , tstop_hr , bw_hz , sgrscat = False , ampcal = True , phasecal = True ) beamparams = obs . fit_beam ( ) res = obs . res ( ) print ( <str> , beamparams ) print ( <str> , res ) npix = 128 fov = 1 * im . fovx ( ) zbl = im . total_flux ( ) prior_fwhm = 200 * eh . RADPERUAS emptyprior = eh . image . make_square ( obs , npix , fov ) flatprior = emptyprior . add_flat ( zbl ) gaussprior = emptyprior . add_gauss ( zbl , ( prior_fwhm , prior_fwhm , 0 , 0 , 0 ) ) flux = zbl imgr = eh . imager . Imager ( obs , gaussprior , gaussprior , flux , data_term = { <str> : 100 } , show_updates = False , reg_term = { <str> : 1 , <str> : 100 , <str> : 50 } , maxit = 200 , ttype = <str> ) imgr . make_image_I ( ) out = imgr . out_last ( ) imgr . init_next = out . blur_circ ( res ) imgr . prior_next = imgr . init_next imgr . dat_term_next = { <str> : 50 , <str> : 100 } imgr . reg_term_next = { <str> : 100 , <str> : 1 , <str> : 1 } imgr . make_image_I ( ) out = imgr . out_last ( ) . threshold ( 0.01 ) imgr . init_next = out . blur_circ ( 0.25 * res ) imgr . prior_next = imgr . init_next imgr . transform_next = <str> imgr . dat_term_next = { <str> : 1 } imgr . reg_term_next = { <str> : 1 } imgr . make_image_P ( ) out = imgr . out_last ( ) imgr . init_next = out . blur_circ ( 0 , .5 * res ) imgr . prior_next = imgr . init_next imgr . transform_next = <str> imgr . dat_term_next = { <str> : 5 } imgr . reg_term_next = { <str> : 1 , <str> : 1.e2 } imgr . make_image_P ( ) out = imgr . out_last ( ) out . display ( plotp = True ) im . display ( plotp = True )  