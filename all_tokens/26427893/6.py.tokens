from __future__ import division from __future__ import print_function import matplotlib . pyplot as plt import numpy as np import ehtim as eh from ehtim . calibrating import self_cal as sc im = eh . image . load_txt ( <str> ) eht = eh . array . load_txt ( <str> ) im . display ( ) tint_sec = 5 tadv_sec = 30 tstart_hr = 0 tstop_hr = 24 bw_hz = 4e9 obs = im . observe ( eht , tint_sec , tadv_sec , tstart_hr , tstop_hr , bw_hz , sgrscat = False , ampcal = True , phasecal = False , ttype = <str> ) beamparams = obs . fit_beam ( ) res = obs . res ( ) print ( <str> , beamparams ) print ( <str> , res ) npix = 128 fov = 1 * im . fovx ( ) zbl = im . total_flux ( ) prior_fwhm = 80 * eh . RADPERUAS emptyprior = eh . image . make_square ( obs , npix , fov ) flatprior = emptyprior . add_flat ( zbl ) gaussprior = emptyprior . add_gauss ( zbl , ( prior_fwhm , prior_fwhm , 0 , 0 , 0 ) ) gaussprior = gaussprior . add_const_pol ( .1 , np . pi / 3 , 0 , 1 ) gausspriorc = gaussprior . switch_polrep ( <str> ) avg_time = 600 obs . add_bispec ( avg_time = avg_time ) obs . add_amp ( avg_time = avg_time ) obs . add_cphase ( avg_time = avg_time ) obs . add_camp ( avg_time = avg_time ) obs . add_logcamp ( avg_time = avg_time ) flux = zbl imgr = eh . imager . Imager ( obs , gaussprior , gaussprior , flux , data_term = { <str> : 100 } , show_updates = False , reg_term = { <str> : 1 , <str> : 100 , <str> : 50 } , maxit = 500 , ttype = <str> ) imgr . make_image ( ) out = imgr . out_last ( ) imgr . init_next = out . blur_circ ( res ) imgr . prior_next = imgr . init_next imgr . dat_term_next = { <str> : 50 , <str> : 100 } imgr . reg_term_next = { <str> : 1 , <str> : 100 , <str> : 50 } imgr . make_image ( ) out = imgr . out_last ( ) imgr . init_next = out . blur_circ ( res / 2 ) imgr . prior_next = imgr . init_next imgr . dat_term_next = { <str> : 10 , <str> : 20 } imgr . reg_term_next = { <str> : 1 , <str> : 100 , <str> : 50 } imgr . maxi_next = 1000 imgr . make_image ( ) out = imgr . out_last ( ) out . display ( )  