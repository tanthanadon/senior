import pytest import numpy as np import odl import odl . contrib . shearlab from odl . util . testutils import all_almost_equal , simple_fixture dtype = simple_fixture ( <str> , [ <str> , <str> ] ) shape = simple_fixture ( <str> , [ ( 64 , 64 ) , ( 128 , 128 ) ] ) def test_operator ( dtype , shape ) :      rel = 100 * np . finfo ( <str> ) . resolution space = odl . uniform_discr ( [ - 1 , - 1 ] , [ 1 , 1 ] , shape , dtype = dtype ) op = odl . contrib . pyshearlab . ShearlabOperator ( space , num_scales = 2 ) phantom = odl . phantom . shepp_logan ( space , True ) y = op ( phantom ) ax = op . adjoint ( y ) assert phantom . inner ( ax ) == pytest . approx ( y . inner ( y ) , rel = rel ) rec = op . inverse ( y ) assert all_almost_equal ( op . inverse ( y ) , phantom ) recadj = op . inverse . adjoint ( rec ) assert pytest . approx ( rec . inner ( rec ) , rel = rel ) == y . inner ( recadj ) adjinvadj = op . adjoint . inverse ( op . adjoint ( y ) ) assert all_almost_equal ( adjinvadj , y , places = 5 ) adjadjinv = op . adjoint ( op . adjoint . inverse ( phantom ) ) assert all_almost_equal ( adjadjinv , phantom , places = 5 )  if __name__ == <str> :      odl . util . test_file ( __file__ )   