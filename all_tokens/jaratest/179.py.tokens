from jaratoolbox import settings import os import glob import sys import importlib import re import numpy as np mouseName = str ( sys . argv [ 1 ] ) allcellsFileName = <str> + mouseName + <str> sys . path . append ( settings . ALLCELLS_PATH ) allcells = importlib . import_module ( allcellsFileName ) ephysRootDir = settings . EPHYS_PATH experimenter = <str> paradigm = <str> numOfCells = len ( allcells . cellDB ) clusNum = 12 numTetrodes = 8 qualityList = [ 1 , 6 ] minZVal = 0.0 maxISIviolation = 0.02 minMovementModulation = 0.1 maxMovementModSig = 0.05 movementModulationWindow = <str> minFileName = <str> + <str> + movementModulationWindow subject = allcells . cellDB [ 0 ] . animalName behavSession = <str> processedDir = os . path . join ( settings . EPHYS_PATH , subject + <str> ) maxZFilename = os . path . join ( processedDir , <str> ) minPerfFilename = os . path . join ( processedDir , <str> ) minTrialFilename = os . path . join ( processedDir , <str> ) ISIFilename = os . path . join ( processedDir , <str> ) nameOfmovementmodSFile = <str> + <str> + movementModulationWindow + <str> + subject + <str> nameOfmovementmodIFile = <str> + <str> + movementModulationWindow + <str> + subject + <str> movementmodIFilename = os . path . join ( processedDir , nameOfmovementmodIFile ) movementmodSFilename = os . path . join ( processedDir , nameOfmovementmodSFile ) class nestedDict ( dict ) :      def __getitem__ ( self , item ) :          try :              return super ( nestedDict , self ) . __getitem__ ( item )  except KeyError :              value = self [ item ] = type ( self ) ( ) return value    maxZFile = open ( maxZFilename , <str> ) minPerfFile = open ( minPerfFilename , <str> ) minTrialFile = open ( minTrialFilename , <str> ) ISIFile = open ( ISIFilename , <str> ) movementmodIFile = open ( movementmodIFilename , <str> ) movementmodSFile = open ( movementmodSFilename , <str> ) minPerfFile . readline ( ) minPerfList = minPerfFile . read ( ) . split ( ) minTrialFile . readline ( ) minTrialFile . readline ( ) minTrialDict = { } for lineCount , line in enumerate ( minTrialFile ) :      minTrialStr = line . split ( <str> ) trialFreq = minTrialStr [ 1 ] . split ( ) minTrialDict . update ( { minTrialStr [ 0 ] [ 1 : ] : trialFreq } )  maxZDict = nestedDict ( ) behavName = <str> for line in maxZFile :      behavLine = line . split ( <str> ) freqLine = line . split ( ) if ( behavLine [ 0 ] == <str> ) :          behavName = behavLine [ 1 ] [ : - 1 ]  else :          maxZDict [ behavName ] [ freqLine [ 0 ] ] = freqLine [ 1 ] . split ( <str> ) [ 0 : - 1 ]   ISIDict = { } behavName = <str> for line in ISIFile :      if ( line . split ( <str> ) [ 0 ] == <str> ) :          behavName = line . split ( <str> ) [ 1 ] [ : - 1 ]  else :          ISIDict [ behavName ] = [ float ( x ) for x in line . split ( <str> ) [ 0 : - 1 ] ]   movementmodIDict = { } movementmodSigDict = { } behavName = <str> for line in movementmodIFile :      if ( line . split ( <str> ) [ 0 ] == <str> ) :          behavName = line . split ( <str> ) [ 1 ] [ : - 1 ]  else :          movementmodIDict [ behavName ] = [ float ( x ) for x in line . split ( <str> ) [ 0 : - 1 ] ]   for line in movementmodSFile :      if ( line . split ( <str> ) [ 0 ] == <str> ) :          behavName = line . split ( <str> ) [ 1 ] [ : - 1 ]  else :          movementmodSigDict [ behavName ] = [ float ( x ) for x in line . split ( <str> ) [ 0 : - 1 ] ]   ISIFile . close ( ) maxZFile . close ( ) minPerfFile . close ( ) minTrialFile . close ( ) movementmodIFile . close ( ) movementmodSFile . close ( ) copyTuningReportsToDir = <str> + subject + <str> + minFileName + <str> if not os . path . exists ( copyTuningReportsToDir ) :      os . makedirs ( copyTuningReportsToDir )  os . chdir ( copyTuningReportsToDir ) files = glob . glob ( <str> ) for filename in files :      os . unlink ( filename )  copyTuningSideinReportsToDir = <str> + subject + <str> + minFileName + <str> if not os . path . exists ( copyTuningSideinReportsToDir ) :      os . makedirs ( copyTuningSideinReportsToDir )  os . chdir ( copyTuningSideinReportsToDir ) files = glob . glob ( <str> ) for filename in files :      os . unlink ( filename )  copyTuningAllfreqReportsToDir = <str> + subject + <str> + minFileName + <str> if not os . path . exists ( copyTuningAllfreqReportsToDir ) :      os . makedirs ( copyTuningAllfreqReportsToDir )  os . chdir ( copyTuningAllfreqReportsToDir ) files = glob . glob ( <str> ) for filename in files :      os . unlink ( filename )  for cellID in range ( 0 , numOfCells ) :      oneCell = allcells . cellDB [ cellID ] if ( behavSession != oneCell . behavSession ) :          print oneCell . behavSession  behavSession = oneCell . behavSession ephysSession = oneCell . ephysSession tetrode = oneCell . tetrode cluster = oneCell . cluster clusterQuality = oneCell . quality [ cluster - 1 ] if clusterQuality not in qualityList :          continue  elif behavSession not in minPerfList :          continue  elif behavSession not in minTrialDict :          continue  elif behavSession not in maxZDict :          continue  elif behavSession not in ISIDict :          continue  elif behavSession not in movementmodIDict :          print <str> + behavSession continue  clusterNumber = ( tetrode - 1 ) * clusNum + ( cluster - 1 ) midFreq = minTrialDict [ behavSession ] [ 0 ] if ( ( ISIDict [ behavSession ] [ clusterNumber ] <= maxISIviolation ) & ( abs ( movementmodIDict [ behavSession ] [ clusterNumber ] ) >= minMovementModulation ) & ( movementmodSigDict [ behavSession ] [ clusterNumber ] <= maxMovementModSig ) ) :          for freq in minTrialDict [ behavSession ] :              os . system ( <str> % ( subject , subject , behavSession , str ( tetrode ) , str ( cluster ) , subject , minFileName ) ) os . system ( <str> % ( subject , subject , behavSession , str ( tetrode ) , str ( cluster ) , subject , minFileName ) ) os . system ( <str> % ( subject , subject , behavSession , str ( tetrode ) , str ( cluster ) , subject , minFileName ) )     