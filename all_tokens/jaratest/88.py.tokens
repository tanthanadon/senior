from jaratoolbox import loadbehavior reload ( loadbehavior ) from jaratoolbox import behavioranalysis reload ( behavioranalysis ) from jaratoolbox import loadopenephys from jaratoolbox import settings import os import numpy as np from pylab import * SAMPLING_RATE = 30000.0 soundTriggerChannel = 0 subject = <str> experimenter = <str> paradigm = <str> behavSession = <str> ephysSession = <str> behavDataFileName = loadbehavior . path_to_behavior_data ( subject , experimenter , paradigm , behavSession ) bdata = loadbehavior . FlexCategBehaviorData ( behavDataFileName , readmode = <str> ) bdata . find_trials_each_block ( ) soundOnsetTimeBehav = bdata [ <str> ] nTrialsBehav = len ( soundOnsetTimeBehav ) ephysDir = os . path . join ( settings . EPHYS_PATH , subject , ephysSession ) eventFilename = os . path . join ( ephysDir , <str> ) events = loadopenephys . Events ( eventFilename ) eventTimes = np . array ( events . timestamps ) / SAMPLING_RATE soundOnsetEvents = ( events . eventID == 1 ) & ( events . eventChannel == soundTriggerChannel ) eventOnsetTimes = eventTimes [ soundOnsetEvents ] nTrialsEphys = len ( eventOnsetTimes ) soundOnsetTimeEphys = eventOnsetTimes print <str> . format ( nTrialsBehav ) print <str> . format ( nTrialsEphys ) sOnBehav = soundOnsetTimeBehav - soundOnsetTimeBehav [ 0 ] sOnEphys = soundOnsetTimeEphys - soundOnsetTimeEphys [ 0 ] minNtrials = min ( nTrialsEphys , nTrialsBehav ) tRange = np . arange ( 0 , minNtrials - 1 ) tDiff = sOnBehav [ tRange ] - sOnEphys [ tRange ] missingTrials = behavioranalysis . find_missing_trials ( soundOnsetTimeEphys , soundOnsetTimeBehav ) print missingTrials clf ( ) plot ( tDiff , <str> , ms = 8 ) show ( )  