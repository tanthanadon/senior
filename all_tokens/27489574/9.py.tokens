import json from . _2to3 import url_quote_plus from . _common_util import response_to_json_dict class SecurityDocument ( dict ) :      def __init__ ( self , database ) :          super ( SecurityDocument , self ) . __init__ ( ) self . _client = database . client self . _database = database self . _database_host = self . _client . server_url self . _database_name = database . database_name self . encoder = self . _client . encoder  @ property def document_url ( self ) :          return <str> . join ( [ self . _database_host , url_quote_plus ( self . _database_name ) , <str> ] )  @ property def r_session ( self ) :          return self . _client . r_session  def json ( self ) :          return json . dumps ( dict ( self ) , cls = self . encoder )  def fetch ( self ) :          resp = self . r_session . get ( self . document_url ) resp . raise_for_status ( ) self . clear ( ) self . update ( response_to_json_dict ( resp ) )  def save ( self ) :          resp = self . r_session . put ( self . document_url , data = self . json ( ) , headers = { <str> : <str> } ) resp . raise_for_status ( )  def __enter__ ( self ) :          self . fetch ( ) return self  def __exit__ ( self , * args ) :          self . save ( )    