import sys import unittest import json from . import unittestsetup from . unittestsetup import environment as environment from . unittestsetup import fetchTestData import requests_mock from oandapyV20 import API from oandapyV20 . exceptions import StreamTerminated import oandapyV20 . endpoints . pricing as pricing from oandapyV20 . endpoints . pricing import responses access_token = None accountID = None account_cur = None api = None class TestPricing ( unittest . TestCase ) :      def setUp ( self ) :          global access_token global accountID global account_cur global api try :              accountID , account_cur , access_token = unittestsetup . auth ( ) setattr ( sys . modules [ <str> ] , <str> , { <str> : { <str> : <str> , <str> : <str> , } } ) api = API ( environment = environment , access_token = access_token ) api . api_url = <str>  except Exception as e :              print ( <str> % e ) exit ( 0 )   @ requests_mock . Mocker ( ) def test__pricing ( self , mock_get ) :          tid = <str> resp , data , params = fetchTestData ( responses , tid ) r = pricing . PricingInfo ( accountID , params = params ) mock_get . register_uri ( <str> , <str> . format ( api . api_url , r ) , text = json . dumps ( resp ) ) result = api . request ( r ) instr = params [ <str> ] . split ( <str> ) self . assertTrue ( result [ <str> ] [ 0 ] [ <str> ] == instr [ 0 ] and result [ <str> ] [ 1 ] [ <str> ] == instr [ 1 ] )  @ requests_mock . Mocker ( ) def test__pricing_stream ( self , mock_get ) :          tid = <str> resp , data , params = fetchTestData ( responses , tid ) text = <str> . join ( [ json . dumps ( t ) for t in resp ] ) r = pricing . PricingStream ( accountID , params = params ) mock_get . register_uri ( <str> , <str> . format ( api . api_url , r ) , text = text ) result = [ ] n = 0 m = 3 with self . assertRaises ( StreamTerminated ) :              for rec in api . request ( r ) :                  result . append ( rec ) n += 1 if n == m :                      r . terminate ( )    self . assertTrue ( result == resp [ 0 : m ] )  def test__pricing_stream_termination_1 ( self ) :          params = { <str> : <str> } r = pricing . PricingStream ( accountID , params = params ) with self . assertRaises ( ValueError ) :              r . terminate ( )    if __name__ == <str> :      unittest . main ( )   