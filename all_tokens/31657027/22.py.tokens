import pytest import ufl import finat from tsfc . finatinterface import create_element , supported_elements @ pytest . fixture ( params = [ <str> , <str> , <str> , <str> , <str> , <str> , <str> ] ) def triangle_names ( request ) :      return request . param  @ pytest . fixture def ufl_element ( triangle_names ) :      return ufl . FiniteElement ( triangle_names , ufl . triangle , 2 )  def test_triangle_basic ( ufl_element ) :      element = create_element ( ufl_element ) assert isinstance ( element , supported_elements [ ufl_element . family ( ) ] )  @ pytest . fixture def ufl_vector_element ( triangle_names ) :      return ufl . VectorElement ( triangle_names , ufl . triangle , 2 )  def test_triangle_vector ( ufl_element , ufl_vector_element ) :      scalar = create_element ( ufl_element ) vector = create_element ( ufl_vector_element ) assert isinstance ( vector , finat . TensorFiniteElement ) assert scalar == vector . base_element  @ pytest . fixture ( params = [ <str> , <str> , <str> ] ) def tensor_name ( request ) :      return request . param  @ pytest . fixture ( params = [ ufl . interval , ufl . triangle , ufl . quadrilateral ] , ids = lambda x : x . cellname ( ) ) def ufl_A ( request , tensor_name ) :      return ufl . FiniteElement ( tensor_name , request . param , 1 )  @ pytest . fixture def ufl_B ( tensor_name ) :      return ufl . FiniteElement ( tensor_name , ufl . interval , 1 )  def test_tensor_prod_simple ( ufl_A , ufl_B ) :      tensor_ufl = ufl . TensorProductElement ( ufl_A , ufl_B ) tensor = create_element ( tensor_ufl ) A = create_element ( ufl_A ) B = create_element ( ufl_B ) assert isinstance ( tensor , finat . TensorProductElement ) assert tensor . factors == ( A , B )  @ pytest . mark . parametrize ( ( <str> , <str> ) , [ ( <str> , finat . GaussLobattoLegendre ) , ( <str> , finat . GaussLegendre ) , ( <str> , finat . GaussLegendre ) ] ) def test_interval_variant_default ( family , expected_cls ) :      ufl_element = ufl . FiniteElement ( family , ufl . interval , 3 ) assert isinstance ( create_element ( ufl_element ) , expected_cls )  @ pytest . mark . parametrize ( ( <str> , <str> , <str> ) , [ ( <str> , <str> , finat . Lagrange ) , ( <str> , <str> , finat . GaussLobattoLegendre ) , ( <str> , <str> , finat . DiscontinuousLagrange ) , ( <str> , <str> , finat . GaussLegendre ) , ( <str> , <str> , finat . DiscontinuousLagrange ) , ( <str> , <str> , finat . GaussLegendre ) ] ) def test_interval_variant ( family , variant , expected_cls ) :      ufl_element = ufl . FiniteElement ( family , ufl . interval , 3 , variant = variant ) assert isinstance ( create_element ( ufl_element ) , expected_cls )  def test_triangle_variant_spectral_fail ( ) :      ufl_element = ufl . FiniteElement ( <str> , ufl . triangle , 2 , variant = <str> ) with pytest . raises ( ValueError ) :          create_element ( ufl_element )   def test_triangle_variant_spectral_fail_l2 ( ) :      ufl_element = ufl . FiniteElement ( <str> , ufl . triangle , 2 , variant = <str> ) with pytest . raises ( ValueError ) :          create_element ( ufl_element )   def test_quadrilateral_variant_spectral_q ( ) :      element = create_element ( ufl . FiniteElement ( <str> , ufl . quadrilateral , 3 , variant = <str> ) ) assert isinstance ( element . product . factors [ 0 ] , finat . GaussLobattoLegendre ) assert isinstance ( element . product . factors [ 1 ] , finat . GaussLobattoLegendre )  def test_quadrilateral_variant_spectral_dq ( ) :      element = create_element ( ufl . FiniteElement ( <str> , ufl . quadrilateral , 1 , variant = <str> ) ) assert isinstance ( element . product . factors [ 0 ] , finat . GaussLegendre ) assert isinstance ( element . product . factors [ 1 ] , finat . GaussLegendre )  def test_quadrilateral_variant_spectral_dq_l2 ( ) :      element = create_element ( ufl . FiniteElement ( <str> , ufl . quadrilateral , 1 , variant = <str> ) ) assert isinstance ( element . product . factors [ 0 ] , finat . GaussLegendre ) assert isinstance ( element . product . factors [ 1 ] , finat . GaussLegendre )  def test_cache_hit ( ufl_element ) :      A = create_element ( ufl_element ) B = create_element ( ufl_element ) assert A is B  def test_cache_hit_vector ( ufl_vector_element ) :      A = create_element ( ufl_vector_element ) B = create_element ( ufl_vector_element ) assert A is B  if __name__ == <str> :      import os import sys pytest . main ( args = [ os . path . abspath ( __file__ ) ] + sys . argv [ 1 : ] )   