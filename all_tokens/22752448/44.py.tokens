import logging import sys import configuration import models as m from sqlobject import sqlbuilder def main ( ) :    configuration . SetUpSqlobjectConnection ( ) total_pkgs = m . Srv4FileStats . select ( ) . count ( ) logging . info ( <str> . format ( total_pkgs ) ) res = m . Srv4FileStats . select ( sqlbuilder . NOTEXISTS ( sqlbuilder . Select ( m . Srv4FileInCatalog . q . id , where = ( sqlbuilder . Outer ( m . Srv4FileStats ) . q . id == m . Srv4FileInCatalog . q . srv4file ) ) ) ) . orderBy ( <str> ) deleted_pkgs = 0 for stats in res :      stats . DeleteAllDependentObjects ( ) stats . destroySelf ( ) deleted_pkgs += 1 sys . stdout . write ( <str> ) sys . stdout . flush ( )  logging . info ( <str> . format ( deleted_pkgs ) )  if __name__ == <str> :    logging . basicConfig ( level = logging . INFO ) main ( )   