import numpy as np import healpy as hp import matplotlib . pyplot as plt from rotate_map_alm import * from astropy . io import fits Nside = 2048 Npix = 12 * Nside ** 2 TQUmap = np . zeros ( ( 3 , Npix ) ) TQUfn = <str> TQUmap = hp . read_map ( TQUfn , field = ( 0 , 1 , 2 ) ) TQUhdr = fits . getheader ( TQUfn ) for i in xrange ( 3 ) :      plt . clf ( ) hp . mollview ( TQUmap [ i ] , coord = <str> ) plt . savefig ( <str> + str ( i ) + <str> )  TQUmap_Equ = np . zeros ( ( 3 , Npix ) ) TQUmap_Equ = rotate_map ( TQUmap , 2000.0 , 2000.0 , <str> , <str> , Nside ) for i in xrange ( 3 ) :      plt . clf ( ) hp . mollview ( TQUmap_Equ [ i ] , coord = <str> ) plt . savefig ( <str> + str ( i ) + <str> )  fits . writeto ( <str> , TQUmap_Equ , TQUhdr )   