import numpy as np import glob , pickle import matplotlib . pyplot as plt import pyfits import healpy as hp from subprocess import call , PIPE Nside = 2048 Npix = 12 * Nside ** 2 thets = np . loadtxt ( <str> ) for theta in thets :      plt . clf ( ) hp . mollview ( theta * np . ones ( Npix ) , unit = <str> , title = <str> + str ( theta ) + <str> , min = 0.0 , max = np . pi , coord = <str> ) plt . savefig ( <str> + str ( theta ) + <str> ) TQUmap = np . zeros ( ( 3 , Npix ) ) TQUmap [ 1 ] = - np . cos ( 2.0 * theta ) TQUmap [ 2 ] = np . sin ( 2.0 * theta ) hp . fitsfunc . write_map ( <str> , TQUmap , coord = <str> ) call ( <str> , shell = True , stdout = PIPE ) call ( <str> , shell = True , stdout = PIPE ) call ( <str> , shell = True , stdout = PIPE ) TQUmapGal = np . zeros ( ( 3 , Npix ) ) TQUmapGal [ 0 ] , TQUmapGal [ 1 ] , TQUmapGal [ 2 ] = hp . fitsfunc . read_map ( <str> , field = ( 0 , 1 , 2 ) ) thetaGal = np . mod ( 0.5 * np . arctan2 ( TQUmapGal [ 2 ] , TQUmapGal [ 1 ] ) , np . pi ) hp . fitsfunc . write_map ( <str> + str ( theta ) + <str> , thetaGal , coord = <str> ) call ( <str> , shell = True , stdout = PIPE ) plt . clf ( ) hp . mollview ( thetaGal , unit = <str> , title = <str> + str ( theta ) + <str> , min = 0.0 , max = np . pi , coord = <str> ) plt . savefig ( <str> + str ( theta ) + <str> )   