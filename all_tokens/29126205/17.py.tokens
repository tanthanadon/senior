import numpy as np import glob , pickle import matplotlib from cycler import cycler matplotlib . rcParams [ <str> ] = cycler ( color = [ <str> , <str> , <str> , <str> , <str> , <str> , <str> , <str> , <str> , <str> ] ) matplotlib . use ( <str> ) matplotlib . rc ( <str> , family = <str> , serif = <str> ) matplotlib . rc ( <str> , usetex = True ) fontProperties = { <str> : <str> , <str> : <str> , <str> : 16 } import matplotlib . pyplot as plt import pyfits import healpy as hp sim_dir = <str> Nside = 2048 Npix = 12 * Nside ** 2 ellmin = 0 ellmax = 4000 ells = np . arange ( ellmin , ellmax + 1 ) ellnormDust = 80. ampDustEE = 7.93 / ellnormDust / ( ellnormDust + 1.0 ) * 2.0 * np . pi ampDustBB = 0.5 * ampDustEE alphaDust = - 2.42 EEDust = ampDustEE * ( ells / ellnormDust ) ** alphaDust BBDust = ampDustBB * ( ells / ellnormDust ) ** alphaDust EEDust [ 0 ] = 0.0 BBDust [ 0 ] = 0.0 TTnull = np . zeros ( len ( ells ) ) TEnull = np . zeros ( len ( ells ) ) TTwhite = np . ones ( len ( ells ) ) * ampDustEE Cellarr = ( TTwhite , EEDust , BBDust , TEnull ) np . savetxt ( sim_dir + <str> , np . transpose ( np . array ( [ EEDust , BBDust ] ) ) ) pl = hp . sphtfunc . pixwin ( Nside , pol = True ) plT = pl [ 0 ] [ 0 : ellmax + 1 ] plP = pl [ 1 ] [ 0 : ellmax + 1 ] Nsim = 100 for i in xrange ( Nsim ) :      print i simmap = hp . sphtfunc . synfast ( Cellarr , nside = Nside , lmax = int ( ellmax ) , pol = True , pixwin = True , new = True , verbose = False ) hp . fitsfunc . write_map ( sim_dir + <str> + str ( i ) + <str> , simmap , coord = <str> , overwrite = True )   