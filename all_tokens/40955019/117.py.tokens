import os import numpy as np from scipy import stats import matplotlib . pyplot as plt import matplotlib . gridspec as gridspec import matplotlib . colors from mpl_toolkits . axes_grid1 . inset_locator import inset_axes from jaratoolbox import settings from jaratoolbox import extraplots reload ( extraplots ) import figparams reload ( figparams ) FIGNAME = <str> dataDir = os . path . join ( settings . FIGURES_DATA_PATH , figparams . STUDY_NAME , FIGNAME ) PANELS = [ 1 , 1 ] SAVE_FIGURE = 1 outputDir = <str> figFilename = <str> figFormat = <str> figSize = [ 6 , 3 ] fontSizeLabels = figparams . fontSizeLabels fontSizeTicks = figparams . fontSizeTicks fontSizePanel = figparams . fontSizePanel PVcolour = figparams . colp [ <str> ] SOMcolour = figparams . colp [ <str> ] ExcColour = figparams . colp [ <str> ] labelPosX = [ 0.01 , 0.49 ] labelPosY = [ 0.94 ] dataFileName = <str> fig = plt . gcf ( ) fig . clf ( ) fig . set_facecolor ( <str> ) gs = gridspec . GridSpec ( 1 , 2 ) gs . update ( top = 0.92 , bottom = 0.17 , left = 0.1 , right = 0.98 , wspace = 0.3 , hspace = 0.3 ) plt . hold ( True ) if PANELS [ 0 ] :      panelLabel = <str> dataFullPath = os . path . join ( dataDir , dataFileName ) data = np . load ( dataFullPath ) ExcSI = data [ <str> ] ExcDiffSum = np . vstack ( data [ <str> ] ) [ : , 0 ] notNanInds = np . where ( ~ np . isnan ( ExcDiffSum ) ) ExcSI = ExcSI [ notNanInds ] ExcDiffSum = ExcDiffSum [ notNanInds ] ALPHA_VAL = 0.05 axScatter = plt . subplot ( gs [ 0 , 0 ] ) plt . plot ( ExcDiffSum , ExcSI , <str> , mec = ExcColour , mfc = ExcColour , ms = 4 ) slope , intercept , rVal , pVal , stdErr = stats . linregress ( ExcDiffSum , ExcSI ) xvals = np . linspace ( - 1 , 1 , 200 ) yvals = slope * xvals + intercept plt . plot ( xvals , yvals , <str> ) print <str> print <str> . format ( rVal , pVal ) plt . xlabel ( <str> ) plt . ylabel ( <str> ) plt . xlim ( - 1.1 , 1.1 ) plt . ylim ( - 0.1 , 1.1 ) axScatter . annotate ( panelLabel , xy = ( labelPosX [ 0 ] , labelPosY [ 0 ] ) , xycoords = <str> , fontsize = fontSizePanel , fontweight = <str> ) extraplots . boxoff ( axScatter )  if PANELS [ 1 ] :      panelLabel = <str> dataFullPath = os . path . join ( dataDir , dataFileName ) data = np . load ( dataFullPath ) ExcSI = data [ <str> ] ExcDiffSum = np . vstack ( data [ <str> ] ) [ : , - 1 ] notNanInds = np . where ( ~ np . isnan ( ExcDiffSum ) ) ExcSI = ExcSI [ notNanInds ] ExcDiffSum = ExcDiffSum [ notNanInds ] ALPHA_VAL = 0.05 axScatter = plt . subplot ( gs [ 0 , 1 ] ) plt . plot ( ExcDiffSum , ExcSI , <str> , mec = ExcColour , mfc = ExcColour , ms = 4 ) slope , intercept , rVal , pVal , stdErr = stats . linregress ( ExcDiffSum , ExcSI ) xvals = np . linspace ( - 1 , 1 , 200 ) yvals = slope * xvals + intercept plt . plot ( xvals , yvals , <str> ) print <str> print <str> . format ( rVal , pVal ) plt . xlabel ( <str> ) plt . ylabel ( <str> ) plt . xlim ( - 1.1 , 1.1 ) plt . ylim ( - 0.1 , 1.1 ) axScatter . annotate ( panelLabel , xy = ( labelPosX [ 1 ] , labelPosY [ 0 ] ) , xycoords = <str> , fontsize = fontSizePanel , fontweight = <str> ) extraplots . boxoff ( axScatter )  if SAVE_FIGURE :      extraplots . save_figure ( figFilename , figFormat , figSize , outputDir )   