from django . core . management . base import BaseCommand , CommandError from django . conf import settings from delft3dworker . models import Scene from os import listdir , walk from os . path import join , dirname , split from shutil import rmtree class Command ( BaseCommand ) :      help = <str> def handle ( self , * args , ** options ) :              ignore = set ( [ join ( settings . WORKER_FILEDIR , <str> ) ] ) scenedirs = [ scene . workingdir . encode ( <str> , <str> ) for scene in Scene . objects . all ( ) ] linked = set ( ) for scenedir in scenedirs :                  if scenedir [ - 1 ] == <str> :                      scenedir = scenedir [ : - 1 ]  linked . add ( scenedir )  r , d , f = next ( walk ( settings . WORKER_FILEDIR ) ) existing = set ( [ join ( r , directory ) for directory in d ] ) linked = linked | ignore unlinked = existing - linked for directory in unlinked :                  try :                      rmtree ( directory ) self . stdout . write ( <str> . format ( directory ) )  except :                      self . stdout . write ( <str> . format ( directory ) )      